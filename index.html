<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üíç Une question importante...</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', Arial, sans-serif;
      background: linear-gradient(135deg, #ffdde1, #ee9ca7);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow-x: hidden;
      position: relative;
    }

    .container {
      width: 95%;
      max-width: 600px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0px 10px 40px rgba(0, 0, 0, 0.2);
      text-align: center;
      position: relative;
      z-index: 5;
    }

    h1 { font-size: 2rem; margin-bottom: 10px; color: #d52f2b; }
    p { font-size: 1rem; color: #333; margin-bottom: 20px; }

    .image-box {
      width: 100%;
      max-height: 60vh;
      border-radius: 18px;
      overflow: hidden;
      margin: 20px 0;
      border: 4px solid #d52f2b;
    }
    .image-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .buttons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      position: relative;
      min-height: 70px;
    }

    button {
      border: none;
      padding: 12px 20px;
      border-radius: 14px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: 600;
      transition: 0.2s ease;
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    }

    #yesBtn { background: #28a745; color: white; }
    #yesBtn:hover { transform: scale(1.08); background: #1e7e34; }

    #noBtn {
      background: #dc3545;
      color: white;
      transition: left 0.1s ease, top 0.1s ease;
    }

    /* Position normale */
    #noBtn.normal-mode {
      position: relative;
      left: auto !important;
      top: auto !important;
    }

    /* Position absolue pour la fuite */
    #noBtn.flee-mode {
      position: absolute;
    }

    #noBtn:hover:not(.flee-mode) { background: #b02a37; }

    .secret-box {
      display: none;
      margin-top: 20px;
      padding: 20px;
      border-radius: 15px;
      background: rgba(255, 0, 100, 0.1);
      border: 2px dashed #d52f2b;
      animation: pop 0.4s ease;
    }
    .secret-box h2 { color: #d52f2b; margin: 0 0 10px; }
    .secret-box p { font-size: 1rem; color: #111; margin: 0; }

    @keyframes pop {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* C≈ìurs flottants */
    .heart {
      position: absolute;
      font-size: 22px;
      animation: float 4s infinite ease-in-out;
      opacity: 0.7;
      pointer-events: none;
      z-index: 2;
    }
    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0); }
    }

    /* Modal personnalis√© */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(5px);
      align-items: center;
      justify-content: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; } to { opacity: 1; }
    }
    .modal-content {
      background: white;
      padding: 30px 40px;
      border-radius: 30px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      text-align: center;
      max-width: 90%;
      animation: modalPop 0.4s ease;
    }
    @keyframes modalPop {
      0% { transform: scale(0.5); opacity: 0; }
      80% { transform: scale(1.05); }
      100% { transform: scale(1); opacity: 1; }
    }
    .modal-emoji {
      font-size: 6rem;
      line-height: 1;
      margin-bottom: 10px;
    }
    .modal-message {
      font-size: 1.5rem;
      font-weight: 600;
      color: #d52f2b;
    }
    .modal-close {
      margin-top: 20px;
      font-size: 1rem;
      color: #888;
      cursor: pointer;
    }
    .modal-close:hover {
      text-decoration: underline;
    }

    /* Confettis */
    @keyframes fall {
      0% { transform: translateY(0); }
      100% { transform: translateY(110vh); }
    }

    @media (max-width: 500px) {
      h1 { font-size: 1.5rem; }
      p, .secret-box p { font-size: 0.9rem; }
      button { font-size: 0.9rem; padding: 10px 18px; }
      .image-box { max-height: 40vh; }
      .modal-emoji { font-size: 4rem; }
      .modal-message { font-size: 1.2rem; }
    }
  </style>
</head>
<body>
  <!-- √âl√©ments flottants -->
  <div class="heart" style="top: 10%; left: 20%;">‚ù§Ô∏è</div>
  <div class="heart" style="top: 20%; left: 80%;">üíç</div>
  <div class="heart" style="top: 70%; left: 10%;">üíñ</div>
  <div class="heart" style="top: 80%; left: 85%;">üíï</div>

  <div class="container">
    <h1>Mon amour... üíï</h1>
    <p>J‚Äôai quelques questions pour toi üò≥</p>

    <div class="image-box" id="mainImage">
      <img src="image1.jpeg" alt="Souhayla & Ahmed" />
    </div>

    <div id="questionBox">
      <p id="questionText" style="font-weight:600;"></p>
      <div class="buttons">
        <button id="yesBtn">Oui üòç</button>
        <button id="noBtn">Non üôÑ</button>
      </div>
    </div>

    <div class="secret-box" id="secretBox">
      <h2>üéâ YESSSSS !!!</h2>
      <p>
        7abibiii, tu viens de rendre ma vie compl√®te ‚ù§Ô∏è<br><br>
        enti la7keya elkoll üò≠üíç‚ú®<br><br>
        <b> ŸÜÿ≠ÿ®ŸÉ Ahmed ‚ù§Ô∏è</b>
      </p>
    </div>
  </div>

  <!-- Modal personnalis√© -->
  <div class="modal-overlay" id="customModal">
    <div class="modal-content">
      <div class="modal-emoji" id="modalEmoji">üò†üòò</div>
      <div class="modal-message" id="modalMessage">Tu dois cocher Oui !</div>
      <div class="modal-close" onclick="closeModal()">Fermer</div>
    </div>
  </div>

  <script>
    (function() {
      const questions = [
        "T7ebbni ? üòò",
        "Bech tdallani ? üíï",
        "Mouch bech t5allini wa7di ? üíñ",
        "Me tor9odech w t5allini nasher wa7di ? üò≠",
        "Veux-tu m'√©pouser ? üíç"
      ];
      const LAST_INDEX = questions.length - 1;

      const questionText = document.getElementById('questionText');
      const yesBtn = document.getElementById('yesBtn');
      const noBtn = document.getElementById('noBtn');
      const secretBox = document.getElementById('secretBox');
      const questionBox = document.getElementById('questionBox');
      const mainImage = document.getElementById('mainImage');
      const modal = document.getElementById('customModal');
      const modalEmoji = document.getElementById('modalEmoji');
      const modalMessage = document.getElementById('modalMessage');

      let currentQuestion = 0;
      let fleeClickCount = 0;
      const FLEE_THRESHOLD = 5;
      let isFleeModeActive = false;

      questionText.innerText = questions[currentQuestion];
      setNormalMode();

      // Fonction pour afficher le modal
      function showModal(emoji, message, duration = 1500) {
        modalEmoji.innerText = emoji;
        modalMessage.innerText = message;
        modal.style.display = 'flex';
        // Fermeture automatique apr√®s duration ms
        setTimeout(closeModal, duration);
      }

      // Fonction pour fermer le modal
      window.closeModal = function() {
        modal.style.display = 'none';
      };

      // Fermer le modal en cliquant sur l'overlay
      modal.addEventListener('click', function(e) {
        if (e.target === modal) closeModal();
      });

      function setNormalMode() {
        isFleeModeActive = false;
        yesBtn.style.display = 'inline-block';
        noBtn.style.display = 'inline-block';
        noBtn.classList.remove('flee-mode');
        noBtn.classList.add('normal-mode');
        noBtn.style.left = '';
        noBtn.style.top = '';
        noBtn.innerText = 'Non üôÑ';
      }

      function setFleeModeForLastQuestion() {
        isFleeModeActive = true;
        fleeClickCount = 0;
        yesBtn.style.display = 'none';
        noBtn.style.display = 'inline-block';
        noBtn.classList.remove('normal-mode');
        noBtn.classList.add('flee-mode');
        noBtn.innerText = 'Non üôÑ';
        positionNoButtonRandomly();
      }

      function applyQuestionMode() {
        if (currentQuestion < LAST_INDEX) {
          setNormalMode();
        } else {
          setFleeModeForLastQuestion();
        }
      }

      function positionNoButtonRandomly() {
        if (!isFleeModeActive) return;
        const container = document.querySelector('.container');
        const containerRect = container.getBoundingClientRect();
        const btnRect = noBtn.getBoundingClientRect();

        const MARGIN = 15;
        let maxX = containerRect.width - btnRect.width - MARGIN;
        let maxY = containerRect.height - btnRect.height - MARGIN;
        let minX = MARGIN;
        let minY = MARGIN;

        if (maxX < minX) {
          minX = 5;
          maxX = containerRect.width - btnRect.width - 5;
        }
        if (maxY < minY) {
          minY = 5;
          maxY = containerRect.height - btnRect.height - 5;
        }
        if (maxX <= 0 || maxY <= 0) return;

        const randomX = Math.floor(Math.random() * (maxX - minX + 1)) + minX;
        const randomY = Math.floor(Math.random() * (maxY - minY + 1)) + minY;

        noBtn.style.left = randomX + 'px';
        noBtn.style.top = randomY + 'px';
      }

      yesBtn.addEventListener('click', function() {
        if (currentQuestion === LAST_INDEX && yesBtn.style.display === 'none') return;

        if (currentQuestion < LAST_INDEX) {
          currentQuestion++;
          questionText.innerText = questions[currentQuestion];
          applyQuestionMode();
        } else if (currentQuestion === LAST_INDEX) {
          triggerFinal();
        }
      });

      noBtn.addEventListener('click', function(e) {
        e.preventDefault();

        if (currentQuestion < LAST_INDEX) {
          // Afficher le modal au lieu de l'alert et de l'emoji g√©ant
          showModal('üò†üòò', 'Tu dois cocher Oui !');
        } else if (currentQuestion === LAST_INDEX) {
          if (isFleeModeActive) {
            fleeClickCount++;
            if (fleeClickCount < FLEE_THRESHOLD) {
              positionNoButtonRandomly();
            } else {
              yesBtn.style.display = 'inline-block';
              isFleeModeActive = false;
              noBtn.classList.remove('flee-mode');
              noBtn.classList.add('normal-mode');
              noBtn.style.left = '';
              noBtn.style.top = '';
              noBtn.innerText = 'Bon d\'accord üòÖ';
            }
          }
        }
      });

      function triggerFinal() {
        questionBox.style.display = 'none';
        secretBox.style.display = 'block';
        mainImage.innerHTML = '<img src="robe_blanc.jpeg" alt="Notre mariage" />';

        for (let i = 0; i < 30; i++) {
          let emoji = document.createElement('div');
          const randomEmoji = ['üíñ', 'üíç', 'üéâ', 'üíï', 'üòò', 'üíí'][Math.floor(Math.random() * 6)];
          emoji.innerText = randomEmoji;
          emoji.style.position = 'fixed';
          emoji.style.left = Math.random() * 100 + 'vw';
          emoji.style.top = '-20px';
          emoji.style.fontSize = '24px';
          emoji.style.animation = 'fall 3s linear';
          emoji.style.pointerEvents = 'none';
          emoji.style.zIndex = '9999';
          document.body.appendChild(emoji);
          setTimeout(() => emoji.remove(), 3000);
        }
        document.querySelector('h1').innerText = 'üíç F√©licitations ma future femme ! üíç';
      }

      // Animation de chute
      if (!document.querySelector('#fallKeyframes')) {
        const style = document.createElement('style');
        style.id = 'fallKeyframes';
        style.innerHTML = `@keyframes fall { 0% { transform: translateY(0); } 100% { transform: translateY(110vh); } }`;
        document.head.appendChild(style);
      }

      window.addEventListener('resize', function() {
        if (isFleeModeActive && noBtn.style.display !== 'none') {
          positionNoButtonRandomly();
        }
      });
    })();
  </script>
</body>
</html>